import { useState } from "react";
import { Link, useNavigate } from "react-router";
import { toast } from "react-toastify";
import { userSignUp } from "../services/users";

const RegistrationForm = () => {
	const [info, setInfo] = useState({
		name: "",
		email: "",
		passwd: "",
		mobile: "",
		address: "",
	});

	const navigate = useNavigate();
	const handleInputFieldChange = (e) =>
		setInfo({ ...info, [e.target.name]: e.target.value });

	const handleSignUpClick = async (e) => {
		try {
			const user = await userSignUp(
				info.email,
				info.passwd,
				info.name,
				info.mobile,
				info.address
			);
			toast.success("User registered with id: " + user.id);
			navigate("/login");
		} catch (err) {
			toast.error(err.message);
		}
	};

	return (
		<div className="container mt-5 d-flex justify-content-center">
			<div className="col-md-6 border border-2 rounded shadow p-4 bg-light">
				<div className="text-center mb-4">
					<h2 className="text-primary">Create Account</h2>
					<p className="text-muted">Please fill in this form to register</p>
				</div>

				<div className="mb-3">
					<label className="form-label fw-bold text-dark">Full Name</label>
					<input
						className="form-control"
						name="name"
						type="text"
						placeholder="Enter your full name"
						onChange={handleInputFieldChange}
					/>
				</div>

				<div className="mb-3">
					<label className="form-label fw-bold text-dark">Email Address</label>
					<input
						className="form-control"
						name="email"
						type="email"
						placeholder="example@mail.com"
						onChange={handleInputFieldChange}
					/>
				</div>

				<div className="mb-3">
					<label className="form-label fw-bold text-dark">Password</label>
					<input
						className="form-control"
						name="passwd"
						type="password"
						placeholder="Create a password"
						onChange={handleInputFieldChange}
					/>
				</div>

				<div className="mb-3">
					<label className="form-label fw-bold text-dark">Mobile Number</label>
					<input
						className="form-control"
						name="mobile"
						type="tel"
						placeholder="10-digit mobile number"
						onChange={handleInputFieldChange}
					/>
				</div>

				<div className="mb-4">
					<label className="form-label fw-bold text-dark">Address</label>
					<input
						className="form-control"
						name="address"
						type="text"
						placeholder="Enter your address"
						onChange={handleInputFieldChange}
					/>
				</div>

				<div className="d-grid gap-2">
					<button className="btn btn-success fw-bold" onClick={handleSignUpClick}>
						Sign Up
					</button>
					<Link to="/login" className="btn btn-outline-primary">
						Already have an account? Sign In
					</Link>
				</div>
			</div>
		</div>
	);
};

export default RegistrationForm;
